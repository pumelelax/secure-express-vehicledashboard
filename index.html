
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secure Express Fleet Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f4f4f4; }
    .Red { background-color: red; color: white; }
    .Yellow { background-color: yellow; }
    .NoExpiry { background-color: lightgray; }
    .Normal { background-color: white; }
    input[type="text"], select { padding: 8px; margin-right: 10px; }
    img { max-width: 100%; height: auto; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Secure Express Fleet Dashboard</h1>
  <input type="file" id="csvFile" accept=".csv"><br><br>
  <input type="text" id="searchInput" placeholder="Search Fleet Number...">
  <select id="filterStatus">
    <option value="All">All</option>
    <option value="Red">Expiring in 7 Days</option>
    <option value="Yellow">Expiring in 30 Days</option>
  </select>
  <div id="tableContainer"></div>
  <img src="vin_expiry_status_chart.png" alt="VIN Expiry Status Chart">
  <script>
    document.getElementById('csvFile').addEventListener('change', function(e) {
      const reader = new FileReader();
      reader.onload = function() {
        const lines = reader.result.split('
');
        const headers = lines[0].split(',');
        const rows = lines.slice(1).map(line => line.split(','));
        window.fleetData = rows.map(row => Object.fromEntries(headers.map((h, i) => [h.trim(), row[i] ? row[i].trim() : ''])));
        renderTable();
      };
      reader.readAsText(e.target.files[0]);
    });

    document.getElementById('searchInput').addEventListener('input', renderTable);
    document.getElementById('filterStatus').addEventListener('change', renderTable);

    function renderTable() {
      const search = document.getElementById('searchInput').value.toLowerCase();
      const filter = document.getElementById('filterStatus').value;
      let html = '<table><thead><tr>';
      const keys = Object.keys(window.fleetData[0]);
      keys.forEach(k => html += `<th>${k}</th>`);
      html += '</tr></thead><tbody>';
      window.fleetData.forEach(row => {
        const status = row['Status'] || 'Normal';
        if ((filter === 'All' || status === filter) && row['Fleet Number'].toLowerCase().includes(search)) {
          html += `<tr class='${status}'>`;
          keys.forEach(k => html += `<td>${row[k]}</td>`);
          html += '</tr>';
        }
      });
      html += '</tbody></table>';
      document.getElementById('tableContainer').innerHTML = html;
    }
  </script>
</body>
</html>
